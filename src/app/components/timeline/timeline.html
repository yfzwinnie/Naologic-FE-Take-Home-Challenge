<div class="timeline-toolbar">
  <app-timescale-picker
    [currentScale]="currentTimescale()"
    (scaleChange)="currentTimescale.set($event)"
  >
  </app-timescale-picker>
</div>
<div class="timeline-wrapper">
  <aside class="sidebar">
    <div class="header-cell">Work Center</div>
    @for (wc of workCenters(); track wc.docId) {
    <div class="wc-cell" [class.active-row]="hoveredRowId() === wc.docId">
      {{ wc.data.name }}
    </div>
    }
  </aside>

  <main class="timeline-area" #scrollArea>
    <div class="grid-container" [style.width.px]="5000">
      <app-timeline-header [pixelsPerDay]="pixelsPerDay()"> </app-timeline-header>
      <div class="today-line" [style.left.px]="todayOffset()">
        <span class="today-label">Today</span>
      </div>

      @for (wc of workCenters(); track wc.docId) {
      <div
        class="timeline-row"
        (mouseenter)="hoveredRowId.set(wc.docId)"
        (mouseleave)="hoveredRowId.set(null)"
        (click)="openCreateForm(wc.docId, '2025-12-23')"
      >
        @for (order of getOrdersForRow(wc.docId); track order.docId) {
        <div
          class="work-order-bar"
          [ngStyle]="calculateBarStyles(order)"
          [attr.data-status]="order.data.status"
          (click)="$event.stopPropagation(); openEditForm(order)"
        >
          <span class="label">{{ order.data.name }}</span>
        </div>
        }
      </div>
      }
    </div>
  </main>
  <app-work-order-form
    [isOpen]="isDrawerOpen()"
    [order]="selectedOrder()"
    (close)="isDrawerOpen.set(false)"
    (save)="handleSaveOrder($event)"
    [updateError]="updateWorkOrderError()"
  >
  </app-work-order-form>
</div>
